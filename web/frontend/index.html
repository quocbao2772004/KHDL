<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MovieFlix - Home</title>
    <link rel="stylesheet" href="css/style.css?v=22">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <!-- Auth Overlay -->
    <div id="authOverlay">
        <div class="auth-box" id="loginBox">
            <h2>Sign In</h2>
            <input type="text" id="loginUser" class="auth-input" placeholder="Username">
            <input type="password" id="loginPass" class="auth-input" placeholder="Password">
            <button class="auth-btn" onclick="handleLogin()">Sign In</button>
            <div class="auth-switch">
                New to MovieFlix? <span onclick="showRegister()">Sign up now.</span>
            </div>
        </div>

        <div class="auth-box" id="registerBox" style="display: none;">
            <h2>Sign Up</h2>
            <input type="text" id="regUser" class="auth-input" placeholder="Username">
            <input type="password" id="regPass" class="auth-input" placeholder="Password">
            <button class="auth-btn" onclick="handleRegister()">Sign Up</button>
            <div class="auth-switch">
                Already have an account? <span onclick="showLogin()">Sign in.</span>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="app">
        <header id="navbar">
            <div class="logo-section">
                <div class="logo" onclick="showHome()" style="cursor:pointer">MOVIEFLIX</div>
                <div class="nav-links">
                    <span onclick="showHome()">Home</span>
                    <span onclick="showEvaluation()">Evaluation</span>
                    <span onclick="showAnalysis()">Analysis</span>
                </div>
            </div>

            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search movies, actors, directors..."
                    onkeypress="handleSearch(event)" oninput="handleSearchInput(event)">
                <button id="searchBtn" onclick="triggerSearch()">Search</button>
            </div>

            <div class="nav-right">
                <div id="userDisplay" style="font-size: 0.9rem; color: #aaa;">User</div>
                <div style="font-size: 0.7rem; color: #555; margin-left: 10px;">v22</div>
                <button onclick="logout()"
                    style="background:none; border:none; color:#fff; cursor:pointer; margin-left: 15px;">Logout</button>
            </div>
        </header>

        <!-- Home View -->
        <div id="home-view">
            <!-- Hero Section -->
            <div class="hero" id="hero">
                <div class="hero-content">
                    <h1 class="hero-title" id="heroTitle">Loading...</h1>
                    <p class="hero-desc" id="heroOverview"></p>
                    <div>
                        <button class="btn btn-play" onclick="playHero()">▶ Play</button>
                        <button class="btn btn-info" onclick="infoHero()">ℹ More Info</button>
                    </div>
                </div>
            </div>

            <!-- Rows -->
            <div class="row" id="mainContent">
                <div id="trendingSection">
                    <h3>Trending Now</h3>
                    <div class="rec-grid" id="trendingRow">
                        <!-- Posters -->
                    </div>
                </div>

                <div id="allMoviesSection" style="margin-top: 60px;">
                    <h3>All Movies</h3>
                    <div class="rec-grid" id="allMoviesGrid">
                        <!-- Grid of movies -->
                    </div>
                    <div id="paginationControls"
                        style="display: flex; justify-content: center; gap: 20px; margin-top: 30px;">
                        <!-- Pagination buttons will be injected here -->
                    </div>
                </div>
            </div>

        </div>

        <div class="row" id="searchResults" style="display:none; padding: 100px 4% 40px;">
            <h3>Search Results</h3>
            <div class="rec-grid" id="searchGrid"></div>
        </div>

        <!-- Evaluation View -->
        <div id="evaluation-view" style="display:none; padding: 100px 4% 40px;">
            <h2 style="margin-bottom: 30px; font-size: 2.5rem;">Model Evaluation</h2>

            <!-- Dataset Overview Section -->
            <div class="dataset-section">
                <h3 style="margin-bottom: 20px; color: #e50914;">Dataset Overview</h3>

                <div class="data-grid">
                    <div class="data-card">
                        <h4>The MovieDB (TMDB)</h4>
                        <p>The raw data was scraped from <strong>themoviedb.org</strong>, consisting of <strong>2,173
                                movies</strong>. This source provides rich metadata but lacks detailed individual user
                            voting information.</p>
                    </div>
                    <div class="data-card" style="border-left-color: #46d369;">
                        <h4>MovieLens Integration</h4>
                        <p>To train the <strong>LightGCN</strong> model, we integrated the <strong>MovieLens
                                25M</strong> dataset. This merging process allows us to identify specific user voting
                            behavior for the collected movies.</p>
                    </div>
                </div>

                <div class="info-table-container">
                    <table class="info-table">
                        <thead>
                            <tr>
                                <th style="width: 30%;">Parameter</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Movie Attributes</strong></td>
                                <td>
                                    <span class="attribute-badge">tmdb_id</span>
                                    <span class="attribute-badge">title</span>
                                    <span class="attribute-badge">overview</span>
                                    <span class="attribute-badge">release_date</span>
                                    <span class="attribute-badge">genres</span>
                                    <span class="attribute-badge">runtime</span>
                                    <span class="attribute-badge">vote_average</span>
                                    <span class="attribute-badge">vote_count</span>
                                    <span class="attribute-badge">popularity</span>
                                    <span class="attribute-badge">cast_top5</span>
                                    <span class="attribute-badge">director</span>
                                    <span class="attribute-badge">keywords</span>
                                    <span class="attribute-badge">poster_path</span>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Merged Dataset Shape</strong></td>
                                <td><code style="color: #46d369; font-size: 1.1rem;">(11,732,970, 4)</code> <span
                                        style="color: #888; margin-left: 10px;">(After merging MovieLens 25M with 2,173
                                        movies)</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h4 style="margin-bottom: 15px; color: #fff;">Training Configuration</h4>
                <div class="training-config">
                    <div class="config-box">
                        <span class="label">Epochs</span>
                        <span class="value">100</span>
                    </div>
                    <div class="config-box">
                        <span class="label">Cap Per Movie</span>
                        <span class="value">4,000</span>
                    </div>
                    <div class="config-box">
                        <span class="label">Optimization</span>
                        <span class="value">Early Stopping</span>
                    </div>
                </div>
            </div>

            <div class="eval-container">
                <div class="eval-card">
                    <h3>BERT Model Performance</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <span class="label">Precision@10</span>
                            <span class="value">0.7740</span>
                        </div>
                        <div class="metric-item">
                            <span class="label">Recall@10</span>
                            <span class="value">0.7740</span>
                        </div>
                    </div>
                    <p style="color: #aaa; margin-top: 15px; font-size: 0.9rem;">* Genre-based relevance evaluation</p>
                </div>

                <div class="eval-card">
                    <h3>LightGCN Model Performance</h3>
                    <div class="metrics-grid">
                        <div class="metric-item">
                            <span class="label">RMSE</span>
                            <span class="value">1.1356</span>
                        </div>
                        <div class="metric-item">
                            <span class="label">MAE</span>
                            <span class="value">0.7798</span>
                        </div>
                        <div class="metric-item">
                            <span class="label">Recall@10</span>
                            <span class="value">0.9934</span>
                        </div>
                        <div class="metric-item">
                            <span class="label">Precision@10</span>
                            <span class="value">0.2009</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row" style="margin-top: 40px; padding-left: 0;">
                <h3>LightGCN Training Loss</h3>
                <div
                    style="background: #1f1f1f; padding: 20px; border-radius: 10px; margin-top: 20px; text-align: center;">
                    <img src="assets/models/lightgcn_loss_plot.png"
                        style="max-width: 100%; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.5);">
                </div>
            </div>

            <div class="row" style="margin-top: 40px; padding-left: 0;">
                <h3>Metrics Visualization</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px;">
                    <div style="background: #1f1f1f; padding: 20px; border-radius: 10px;">
                        <canvas id="bertChart"></canvas>
                    </div>
                    <div style="background: #1f1f1f; padding: 20px; border-radius: 10px;">
                        <canvas id="lightgcnChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis View -->
        <div id="analysis-view" style="display:none; padding: 100px 4% 40px;">
            <h2 style="margin-bottom: 30px; font-size: 2.5rem;">Data Analysis</h2>

            <div class="row" style="padding-left: 0;">
                <h3 style="margin-bottom: 20px; color: #e50914;">The MovieDB Data Analysis</h3>
                <div class="analysis-grid">
                    <!-- PNGs -->
                    <div class="analysis-card">
                        <h4>Top Genres</h4>
                        <img src="assets/data_themoviedb/top_genres.png" alt="Top Genres">
                    </div>
                    <div class="analysis-card">
                        <h4>Top Frequent Actors</h4>
                        <img src="assets/data_themoviedb/top_frequent_actors.png" alt="Top Actors">
                    </div>
                    <div class="analysis-card">
                        <h4>Movie Ratings Distribution</h4>
                        <img src="assets/data_themoviedb/movie_ratings.png" alt="Movie Ratings">
                    </div>
                    <div class="analysis-card">
                        <h4>Rating vs Popularity</h4>
                        <img src="assets/data_themoviedb/rating_vs_popularity.png" alt="Rating vs Popularity">
                    </div>
                    <div class="analysis-card">
                        <h4>Top Popularity Movies</h4>
                        <img src="assets/data_themoviedb/top_popularity_movies.png" alt="Top Popularity">
                    </div>
                    <!-- HTML Charts -->
                    <div class="analysis-card">
                        <h4>Interactive: Movie Popularity vs Rating</h4>
                        <iframe src="assets/data_themoviedb/movie_popularity_vs_rating.html"></iframe>
                    </div>
                    <div class="analysis-card">
                        <h4>Interactive: Movie Ratings</h4>
                        <iframe src="assets/data_themoviedb/movie_ratings.html"></iframe>
                    </div>
                    <div class="analysis-card">
                        <h4>Interactive: Movies Over Time</h4>
                        <iframe src="assets/data_themoviedb/movies_over_time.html"></iframe>
                    </div>
                    <div class="analysis-card">
                        <h4>Interactive: Top Popular Movies</h4>
                        <iframe src="assets/data_themoviedb/top_popular_movies.html"></iframe>
                    </div>
                </div>
            </div>

            <div class="row" style="margin-top: 60px; padding-left: 0;">
                <h3 style="margin-bottom: 20px; color: #e50914;">MovieLens & TMDB Merged Analysis</h3>
                <div class="analysis-grid">
                    <!-- PNGs -->
                    <div class="analysis-card">
                        <h4>Rating Distribution</h4>
                        <img src="assets/movie_lens_map_themoviedb/rating_distribution.png" alt="Rating Distribution">
                    </div>
                    <div class="analysis-card">
                        <h4>Number of Ratings by Year</h4>
                        <img src="assets/movie_lens_map_themoviedb/number_of_ratings_by_year.png" alt="Ratings by Year">
                    </div>
                    <div class="analysis-card">
                        <h4>Popularity vs Rating</h4>
                        <img src="assets/movie_lens_map_themoviedb/popularity_vs_rating.png" alt="Popularity vs Rating">
                    </div>
                    <div class="analysis-card">
                        <h4>Rating per Movie</h4>
                        <img src="assets/movie_lens_map_themoviedb/rating_per_movie.png" alt="Rating per Movie">
                    </div>
                    <div class="analysis-card">
                        <h4>Rating per User</h4>
                        <img src="assets/movie_lens_map_themoviedb/rating_per_user.png" alt="Rating per User">
                    </div>
                    <!-- HTML Charts -->
                    <div class="analysis-card">
                        <h4>Interactive: Avg Rating by Popularity Decile</h4>
                        <iframe
                            src="assets/movie_lens_map_themoviedb/average_rating_by_popularity_decile.html"></iframe>
                    </div>
                    <div class="analysis-card">
                        <h4>Interactive: Avg Rating by Year</h4>
                        <iframe src="assets/movie_lens_map_themoviedb/average_rating_by_year.html"></iframe>
                    </div>
                    <div class="analysis-card">
                        <h4>Interactive: Number of Ratings by Year</h4>
                        <iframe src="assets/movie_lens_map_themoviedb/number_of_ratings_by_year.html"></iframe>
                    </div>
                    <div class="analysis-card">
                        <h4>Interactive: Popularity vs Rating</h4>
                        <iframe src="assets/movie_lens_map_themoviedb/popularity_vs_rating.html"></iframe>
                    </div>
                    <div class="analysis-card">
                        <h4>Interactive: User Activity vs Rating Bias</h4>
                        <iframe src="assets/movie_lens_map_themoviedb/user_activity_vs_rating_bias.html"></iframe>
                    </div>
                </div>
            </div>
        </div>

        <!-- Movie Details View (Hidden by default) -->
        <div id="movie-view" style="display:none; padding-top: 80px;">
            <button onclick="showHome()"
                style="margin: 20px; padding: 10px 20px; background: #333; color: white; border: none; cursor: pointer;">&larr;
                Back to Home</button>

            <div class="hero" id="detailsHero" style="height: 60vh;">
                <div class="hero-content">
                    <h1 class="hero-title" id="detailsTitle">Loading...</h1>
                    <div class="modal-meta" id="detailsMeta"
                        style="margin-bottom: 20px; font-size: 1.2rem; color: #ccc;"></div>
                    <p class="hero-desc" id="detailsOverview"></p>
                    <button class="btn btn-play" onclick="alert('Playing movie...')">▶ Play</button>
                </div>
            </div>

            <div class="row">
                <h3>Recommendations</h3>
                <div class="rec-grid" id="detailsRecs">
                    <!-- Recommendations -->
                </div>
            </div>
            <div class="row" id="cfRecsSection" style="display:none; margin-top: 40px;">
                <h3>You may also like</h3>
                <div class="rec-grid" id="cfRecs">
                    <!-- Collaborative Filtering Recommendations -->
                </div>
            </div>
        </div>

    </div>

    <script src="js/app.js?v=22"></script>
</body>

</html>